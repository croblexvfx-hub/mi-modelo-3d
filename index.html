<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.4/dist/mindar-image-aframe.prod.js"></script>
    <style>
      body { margin: 0; overflow: hidden; }

      .ui-button {
        position: fixed;
        bottom: 20px;
        width: 60px;
        height: 60px;
        font-size: 30px;
        border-radius: 50%;
        border: none;
        background: rgba(0,0,0,0.6);
        color: white;
        z-index: 2;
      }

      #prev { left: 20px; }
      #next { right: 20px; }
    </style>
  </head>

  <body>

    <button id="prev" class="ui-button">←</button>
    <button id="next" class="ui-button">→</button>

    <a-scene
      mindar-image="imageTargetSrc: margot_targets.mind; filterMinCF: 0.0001; filterBeta: 0.003;"
      color-space="sRGB"
      renderer="colorManagement: true, physicallyCorrectLights"
      vr-mode-ui="enabled: false"
      device-orientation-permission-ui="enabled: false"
    >

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <a-entity id="anchor" mindar-image-target="targetIndex: 0"></a-entity>

    </a-scene>

    <script>
      const models = [
        "./Plato_01.glb",
        "./Plato_02.glb"
      ];

      let index = 0;
      let currentContainer = null;

      const anchor = document.querySelector("#anchor");

      function loadModel() {

        // Eliminar modelo anterior
        if (currentContainer) {
          anchor.removeChild(currentContainer);
        }

        // Crear contenedor (mejora estabilidad rotación)
        const container = document.createElement("a-entity");
        container.setAttribute("position", "0 0 0");
        container.setAttribute("rotation", "0 0 0");

        // Crear modelo
        const model = document.createElement("a-gltf-model");
        model.setAttribute("src", models[index]);
        model.setAttribute("position", "0 0 0");
        model.setAttribute("rotation", "90 0 0");
        model.setAttribute("scale", "4.7 4.7 4.7");

        container.appendChild(model);
        anchor.appendChild(container);

        currentContainer = container;
      }

      document.querySelector("#prev").addEventListener("click", () => {
        index = (index - 1 + models.length) % models.length;
        loadModel();
      });

      document.querySelector("#next").addEventListener("click", () => {
        index = (index + 1) % models.length;
        loadModel();
      });

      // Cargar primer modelo al iniciar
      loadModel();

    </script>

  </body>
</html>
